define(`nexus_verified_client', `
allow $1 nexus_data_file:dir { search read };
allow $1 nexus_data_file:file { read open getattr };
dontaudit $1 nexus_vendor_data_file:dir { search };
dontaudit $1 nexus_vendor_data_file:file { read open getattr };
')

define(`nexus_vendor_verified_client', `
allow $1 nexus_vendor_data_file:dir { search read };
allow $1 nexus_vendor_data_file:file { read open getattr };
dontaudit $1 nexus_data_file:dir { search };
dontaudit $1 nexus_data_file:file { read open getattr };
')

define(`nexus_verified_client_ignored', `
dontaudit $1 nexus_data_file:dir { search };
dontaudit $1 nexus_data_file:file { read open getattr };
dontaudit $1 nexus_vendor_data_file:dir { search };
dontaudit $1 nexus_vendor_data_file:file { read open getattr };
')

define(`nexus_debugable', `
allow $1 nexus_debug_file:dir { search read write add_name remove_name };
allow $1 nexus_debug_file:file { open create read write setattr getattr };
')

define(`nexus_vendor_debugable', `
allow $1 nexus_vendor_debug_file:dir { search read write add_name remove_name };
allow $1 nexus_vendor_debug_file:file { open create read write setattr getattr };
')

define(`nexus_vendor_mediacas', `
allow $1 nexus_vendor_mediacas_file:dir { search read write add_name remove_name };
allow $1 nexus_vendor_mediacas_file:file { open create read write setattr getattr unlink };
')

define(`nexus_firmware', `
allow $1 nexus_fw_file:dir { search read write add_name remove_name };
allow $1 nexus_fw_file:file { open create read write setattr getattr };
')

define(`nexus_secdma', `
allow $1 nexus_secdma_file:file { open create read write setattr getattr unlink };
allow $1 nexus_secdma_file:dir { search setattr write add_name remove_name };
')

define(`nexus_hwservice', `
hwbinder_use($1);
allow $1 vnd_nexus_hwservice:hwservice_manager find;
allow $1 nxserver:binder call;
allow $1 nxserver:binder transfer;
')

define(`nexus_ir', `
allow $1 nexus_ir_file:file { open read getattr };
allow $1 nexus_ir_file:dir { search };
')

define(`nexus_ssd', `
allow $1 nexus_ssd_file:file { open create read write setattr getattr unlink };
allow $1 nexus_ssd_file:dir { search setattr write add_name remove_name };
')

define(`hwcfg_vfat', ifelse(target_hwcfg_type, `vfat', $1, ))
define(`hwcfg_cramfs', ifelse(target_hwcfg_type, `cramfs', $1, ))
define(`hwcfg_ext4', ifelse(target_hwcfg_type, `ext4', $1, ))

define(`nexus_hwcfg', `
hwcfg_vfat(`
allow $1 vfat:file rw_file_perms;
allow $1 vfat:dir { r_dir_perms search };
')
hwcfg_cramfs(`
allow $1 readonlyfs:file r_file_perms;
allow $1 readonlyfs:dir { r_dir_perms search };
')
hwcfg_ext4(`
allow $1 unlabeled:file r_file_perms;
allow $1 unlabeled:dir { r_dir_perms search };
')
')

define(`casproxy_hwservice', `
hwbinder_use($1);
allow $1 vnd_casproxy_hwservice:hwservice_manager find;
')

define(`dspsvcext_hwservice', `
hwbinder_use($1);
allow $1 vnd_dspsvcext_hwservice:hwservice_manager find;
')

define(`bp3_hwservice', `
hwbinder_use($1);
allow $1 vnd_bp3_hwservice:hwservice_manager find;
')

define(`nexus_sys_prop_allowed', ifelse(target_nxsysprop, `true', $1, ))

define(`nexus_sys_prop_forced', `
nexus_sys_prop_allowed(`
allow $1 system_prop:property_service set;
')
')

define(`sdbhak_hwservice', `
hwbinder_use($1);
allow $1 vnd_sdbhak_hwservice:hwservice_manager find;
')

define(`sfhak_hwservice', `
hwbinder_use($1);
allow $1 vnd_sfhak_hwservice:hwservice_manager find;
')

define(`nexus_sdbhak', `
allow $1 nexus_sdbhak_file:file { open create read write setattr getattr unlink };
allow $1 vendor_data_file:file { open read getattr };
allow $1 nexus_sdbhak_file:dir { search setattr write add_name remove_name };
')

define(`tvisvcext_hwservice', `
hwbinder_use($1);
allow $1 vnd_tvisvcext_hwservice:hwservice_manager find;
')

define(`dpthak_hwservice', `
hwbinder_use($1);
allow $1 vnd_dpthak_hwservice:hwservice_manager find;
')

define(`nexus_pak', `
allow $1 nexus_pak_file:file { open read getattr };
allow $1 nexus_pak_file:dir { search };
')

define(`nexus_kmgk', `
allow $1 nexus_kmgk_file:file { open read getattr };
allow $1 nexus_kmgk_file:dir { search };
allow $1 vendor_data_file:file { open read getattr };
')

define(`nexus_jwl', `
allow $1 nexus_jwl_file:file { open read getattr };
allow $1 vendor_data_file:file { open read getattr };
')

define(`nexus_thermal_cfg', `
allow $1 nexus_thermal_file:file { open read getattr };
allow $1 vendor_data_file:file { open read getattr };
')

define(`nexus_thermal', `
allow $1 sysfs_thermal:dir r_dir_perms;
allow $1 sysfs_thermal:file rw_file_perms;
allow $1 sysfs_thermal:lnk_file r_file_perms;
allow $1 proc_stat:file r_file_perms;
')

define(`nexus_sopass', `
allow $1 nexus_sopass_file:file { open read getattr };
allow $1 vendor_data_file:file { open read getattr };
')

define(`nexus_idc', `
allow $1 nexus_idc_file:file { open read getattr };
allow $1 nexus_idc_file:dir { search };
')

define(`nexus_tee', `
allow $1 nexus_tee_file:file { open read getattr };
allow $1 nexus_tee_file:dir { search };
')

define(`nexus_kl', `
allow $1 nexus_kl_file:file { open read getattr };
allow $1 nexus_kl_file:dir { search };
')

define(`nexus_fkbat', `
allow $1 nexus_vendor_fkbat_file:file { open read getattr };
allow $1 nexus_vendor_fkbat_file:dir { search };
')

define(`nexus_vdr_prop_allowed', ifelse(target_nxvdrprop, `true', $1, ))

define(`nexus_vdr_prop_forced', `
nexus_vdr_prop_allowed(`
allow $1 vendor_default_prop:property_service set;
')
')

define(`prdysc_hwservice', `
hwbinder_use($1);
allow $1 vnd_prdysc_hwservice:hwservice_manager find;
')

define(`nexus_vendor_ssl', `
allow $1 nexus_vendor_ssl_file:dir rw_dir_perms;
allow $1 nexus_vendor_ssl_file:file rw_file_perms;
allow $1 nexus_vendor_ssl_file:file create_file_perms;
')
