define(`nexus_verified_client', `
allow $1 nexus_data_file:dir { search read };
allow $1 nexus_data_file:file { read open getattr };
dontaudit $1 nexus_vendor_data_file:dir { search };
dontaudit $1 nexus_vendor_data_file:file { read open getattr };
')

define(`nexus_vendor_verified_client', `
allow $1 nexus_vendor_data_file:dir { search read };
allow $1 nexus_vendor_data_file:file { read open getattr };
dontaudit $1 nexus_data_file:dir { search };
dontaudit $1 nexus_data_file:file { read open getattr };
')

define(`nexus_verified_client_ignored', `
dontaudit $1 nexus_data_file:dir { search };
dontaudit $1 nexus_data_file:file { read open getattr };
dontaudit $1 nexus_vendor_data_file:dir { search };
dontaudit $1 nexus_vendor_data_file:file { read open getattr };
')

define(`nexus_debugable', `
allow $1 nexus_debug_file:dir { search read write add_name remove_name };
allow $1 nexus_debug_file:file { open create read write setattr getattr };
')

define(`nexus_vendor_debugable', `
allow $1 nexus_vendor_debug_file:dir { search read write add_name remove_name };
allow $1 nexus_vendor_debug_file:file { open create read write setattr getattr };
')

define(`nexus_firmware', `
allow $1 nexus_fw_file:dir { search read write add_name remove_name };
allow $1 nexus_fw_file:file { open create read write setattr getattr };
')

define(`nexus_secdma', `
allow $1 nexus_secdma_file:file { open create read write setattr getattr unlink };
allow $1 nexus_secdma_file:dir { search setattr write add_name remove_name };
')

define(`nexus_hwservice', `
hwbinder_use($1);
allow $1 vnd_nexus_hwservice:hwservice_manager find;
allow $1 nxserver:binder call;
allow $1 nxserver:binder transfer;
')

define(`nexus_ir', `
allow $1 nexus_ir_file:file { open read getattr };
allow $1 nexus_ir_file:dir { search };
')

define(`nexus_ssd', `
allow $1 nexus_ssd_file:file { open create read write setattr getattr unlink };
allow $1 nexus_ssd_file:dir { search setattr write add_name remove_name };
')

define(`not_bp3', ifelse(target_bp3, `false', $1, ))
define(`bp3', ifelse(target_bp3, `true', $1, ))

define(`nexus_hwcfg', `
bp3(`
allow $1 vfat:file rw_file_perms;
allow $1 vfat:dir { r_dir_perms search };
')
not_bp3(`
allow $1 readonlyfs:file r_file_perms;
allow $1 readonlyfs:dir { r_dir_perms search };
')
')

define(`dspsvcext_hwservice', `
hwbinder_use($1);
allow $1 vnd_dspsvcext_hwservice:hwservice_manager find;
')

define(`bp3_hwservice', `
hwbinder_use($1);
allow $1 vnd_bp3_hwservice:hwservice_manager find;
')

define(`nexus_sys_prop_allowed', ifelse(target_nxsysprop, `true', $1, ))

define(`nexus_sys_prop_forced', `
nexus_sys_prop_allowed(`
allow $1 system_prop:property_service set;
')
')

define(`nexus_nx_prop_forced', `
nexus_sys_prop_allowed(`
allow $1 nexus_prop:property_service set;
')
')

define(`sdbhak_hwservice', `
hwbinder_use($1);
allow $1 vnd_sdbhak_hwservice:hwservice_manager find;
')

define(`nexus_sdbhak', `
allow $1 nexus_sdbhak_file:file { open create read write setattr getattr unlink };
allow $1 vendor_data_file:file { open read getattr };
allow $1 nexus_sdbhak_file:dir { search setattr write add_name remove_name };
')

define(`tvisvcext_hwservice', `
hwbinder_use($1);
allow $1 vnd_tvisvcext_hwservice:hwservice_manager find;
')

define(`dpthak_hwservice', `
hwbinder_use($1);
allow $1 vnd_dpthak_hwservice:hwservice_manager find;
')

define(`nexus_pak', `
allow $1 nexus_pak_file:file { open read getattr };
allow $1 nexus_pak_file:dir { search };
')
